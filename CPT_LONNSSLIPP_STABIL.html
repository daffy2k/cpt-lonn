<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>CPT Lønnsslipp – Stabil versjon</title>
<style>
body { font-family: Arial, sans-serif; max-width: 720px; margin: 40px auto; }
label { display:block; margin-top:10px; }
input, select, button { width:100%; padding:6px; }
button { margin-top:20px; font-size:16px; }
table { width:100%; border-collapse:collapse; margin-top:20px; }
th, td { border:1px solid #ccc; padding:8px; }
th { background:#f2f2f2; }
td:last-child { text-align:right; }
.summary { margin-top:20px; font-size:18px; font-weight:bold; }
</style>
</head>
<body>

<h2>Kaptein – Lønnsslipp</h2>

<label>År</label>
<select id="year">
<option value="2025">2025</option>
<option value="2026">2026</option>
<option value="2027">2027</option>
</select>

<label>Ansiennitetstrinn</label>
<input id="step" type="number" value="7">

<label>Skatt (%)</label>
<input id="tax" type="number" value="30">

<hr>

<label>Block Hours</label>
<input id="blh" type="number" value="0">

<label>Natt BLH</label>
<input id="night" type="number" value="0">

<label>Helligdag BLH</label>
<input id="holiday" type="number" value="0">

<label>Line training BLH</label>
<input id="ltc" type="number" value="0">

<label>Simulator timer</label>
<input id="sim" type="number" value="0">

<label>Late changes</label>
<input id="late" type="number" value="0">

<label>BDO dager</label>
<input id="bdo" type="number" value="0">

<label>Per diem (skattefri)</label>
<input id="perdiem" type="number" value="0">

<label>Overtidstimer</label>
<input id="ot" type="number" value="0">

<button id="calcBtn">Beregn lønn</button>

<table id="table" style="display:none">
<thead><tr><th>Post</th><th>€</th></tr></thead>
<tbody id="tbody"></tbody>
</table>

<div class="summary" id="summary"></div>

<script>
const basicPay = {
2025:{7:8739},
2026:{7:9045},
2027:{7:9362}
};

document.getElementById("calcBtn").addEventListener("click", function () {

  const v = id => Number(document.getElementById(id).value) || 0;
  const year = document.getElementById("year").value;
  const step = v("step");
  const taxRate = v("tax") / 100;

  const base = (basicPay[year] && basicPay[year][step]) || 0;
  const hourly = base / 152;

  const rows = [];
  let taxable = 0;

  function add(name, val, tax=true){
    if(val === 0) return;
    rows.push({name,val});
    if(tax) taxable += val;
  }

  add("Fastlønn", base);
  add("Block hours", v("blh") * 12);
  add("Natt tillegg", v("night") * 12 * 0.5);
  add("Helligdag tillegg", v("holiday") * 12);
  add("Line training", v("ltc") * 45);
  add("Simulator", v("sim") * 45);
  add("Late change", v("late") * 250);
  add("BDO", v("bdo") * base * 0.10);
  add("Telefon", 60);
  add("Uniform", 100);
  add("Overtid", v("ot") * hourly * 2);

  const perdiem = v("perdiem");
  add("Per diem (skattefri)", perdiem, false);

  const tax = taxable * taxRate;
  const net = taxable - tax + perdiem;

  const tbody = document.getElementById("tbody");
  tbody.innerHTML = "";
  rows.forEach(r => {
    tbody.innerHTML += `<tr><td>${r.name}</td><td>${r.val.toFixed(0)}</td></tr>`;
  });

  document.getElementById("table").style.display = "table";
  document.getElementById("summary").innerHTML =
    `Brutto skattepliktig: € ${taxable.toFixed(0)}<br>
     Skatt: € ${tax.toFixed(0)}<br>
     Netto utbetalt: € ${net.toFixed(0)}`;
});
</script>

</body>
</html>
